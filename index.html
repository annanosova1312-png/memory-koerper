<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>K√∂rper Memory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
  <style>
    :root {
      --pink: #ff6bb5;
      --yellow: #ffe66d;
      --green: #1dd3b0;
      --purple: #6c5ce7;
      --orange: #ff9f43;
    }

    * {
      box-sizing: border-box;
      user-select: none;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Comic Sans MS", "Baloo", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
      background: #222 url("memory_fon.jpg") center/cover fixed no-repeat;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.35), transparent),
        linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.1));
      mix-blend-mode: screen;
      z-index: 0;
    }

    .game-wrapper {
      position: relative;
      z-index: 1;
      max-width: 960px;
      width: min(96vw, 960px);
      padding: 1.5rem 1.5rem 2rem;
      border-radius: 1.7rem;
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
      border: 5px solid rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      animation: wrapper-pop 0.7s ease-out;
    }

    h1 {
      margin: 0 0 1rem;
      text-align: center;
      font-size: clamp(2.1rem, 7vw, 3.3rem);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: linear-gradient(45deg, var(--pink), var(--yellow), var(--green), var(--purple));
      -webkit-background-clip: text;
      color: transparent;
      text-shadow: 0 0 12px rgba(255, 255, 255, 0.9);
      animation: glow 3s ease-in-out infinite alternate;
    }

    .subtitle {
      text-align: center;
      margin: 0 0 1.2rem;
      font-size: clamp(0.9rem, 2.8vw, 1.1rem);
      color: #555;
    }

    .board-wrapper {
      position: relative;
    }

    #game-board {
      display: grid;
      grid-template-columns: repeat(4, minmax(70px, 1fr));
      gap: 0.8rem;
      padding: 1rem;
      border-radius: 1.4rem;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
      position: relative;
      overflow: hidden;
      animation: board-in 0.7s ease-out;
    }

    #game-board::before {
      content: "";
      position: absolute;
      inset: -30%;
      background-image: radial-gradient(circle at 20% 0%, rgba(255, 107, 181, 0.25) 0, transparent 55%),
        radial-gradient(circle at 80% 100%, rgba(111, 214, 255, 0.25) 0, transparent 55%),
        radial-gradient(circle at 0% 100%, rgba(255, 230, 109, 0.2) 0, transparent 60%);
      opacity: 0.7;
      pointer-events: none;
      z-index: 0;
    }

    #game-board.blurred {
      filter: blur(4px) brightness(0.9);
      pointer-events: none;
    }

    .card {
      position: relative;
      width: 100%;
      max-width: 150px;
      aspect-ratio: 3 / 4;
      perspective: 1100px;
      cursor: pointer;
      z-index: 1;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.5s ease, box-shadow 0.2s ease;
      border-radius: 1.2rem;
    }

    .card:not(.matched):hover .card-inner {
      transform: translateY(-4px) scale(1.03);
      box-shadow: 0 10px 18px rgba(0, 0, 0, 0.3);
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      inset: 0;
      border-radius: 1.2rem;
      border: 4px solid #ffffff;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(3rem, 8vw, 4rem);
      font-weight: bold;
    }

.card-front {
  background: linear-gradient(135deg, #ff6bb5, #ffe66d);
  color: #333;
  text-shadow: 0 0 4px rgba(255, 255, 255, 0.7);
  font-weight: bold;
  font-size: clamp(3rem, 8vw, 4rem);
  display: flex;
  align-items: center;
  justify-content: center;
}

    .card-back {
      transform: rotateY(180deg);
      background: #ffffff;
      padding: 0.35rem;
    }

    .card-back img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 0.9rem;
    }

    .card.matched .card-inner {
      animation: matched-pulse 0.75s ease;
    }

    .helper-text {
      text-align: center;
      margin-top: 0.6rem;
      font-size: 0.9rem;
      color: #777;
    }

    /* Overlays */
    .overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.85));
      z-index: 10;
      opacity: 1;
      pointer-events: auto;
      transition: opacity 0.35s ease;
    }

    .overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .overlay-content {
      position: relative;
      max-width: 640px;
      width: min(94vw, 640px);
      padding: 1.6rem 1.5rem 2rem;
      border-radius: 1.8rem;
      background: radial-gradient(circle at top, #fff7e6, #ffe0f7);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.5);
      border: 5px solid rgba(255, 255, 255, 0.95);
      text-align: center;
      overflow: hidden;
      animation: pop-in 0.45s ease-out;
    }

    .overlay-title {
      margin: 0 0 0.75rem;
      font-size: clamp(2rem, 6vw, 2.7rem);
      color: #ff477e;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.9);
    }

    .overlay-subtitle {
      margin: 0 0 1rem;
      font-size: clamp(1rem, 3vw, 1.2rem);
      color: #555;
    }

    .overlay-images {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
      margin-top: 0.2rem;
    }

    .overlay-images img {
      width: min(40vw, 200px);
      border-radius: 1.2rem;
      border: 5px solid #ffffff;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
      background: #ffffff;
    }

    /* End screen */
    #end-overlay .overlay-content {
      padding-bottom: 3.8rem;
      background: radial-gradient(circle at top, #fffbe6, #ffe0f7, #e3f9ff);
    }

    #fireworks {
      position: absolute;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
      z-index: -1;
    }

    .firework {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.95),
        0 0 0 8px rgba(255, 255, 255, 0.65),
        0 0 18px rgba(255, 255, 255, 0.95);
      animation: explode 1.5s ease-out infinite;
    }

    .firework::before,
    .firework::after {
      content: "";
      position: absolute;
      inset: -14px;
      border-radius: 50%;
      border: 3px dotted rgba(255, 255, 255, 0.9);
    }

    .firework::before {
      transform: rotate(25deg);
    }

    .firework::after {
      transform: rotate(-25deg);
    }

    #play-again-btn {
      position: absolute;
      left: 50%;
      bottom: 1.2rem;
      transform: translateX(-50%);
      border: none;
      border-radius: 999px;
      padding: 0.7rem 2.7rem;
      font-size: clamp(1.3rem, 4vw, 1.7rem);
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #ffffff;
      background-image: linear-gradient(135deg, #ff6bb5, #ff9f43, #ffe66d);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.35);
      cursor: pointer;
      text-shadow: 0 0 6px rgba(0, 0, 0, 0.45);
      animation: bounce 1.2s ease-in-out infinite alternate;
    }

    #play-again-btn:active {
      transform: translateX(-50%) translateY(2px) scale(0.98);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }

    @keyframes glow {
      0% {
        text-shadow: 0 0 8px rgba(255, 255, 255, 0.9), 0 0 16px rgba(255, 255, 255, 0.6);
      }
      100% {
        text-shadow: 0 0 16px rgba(255, 255, 255, 1), 0 0 26px rgba(255, 255, 255, 0.9);
      }
    }

    @keyframes wrapper-pop {
      from {
        transform: translateY(30px) scale(0.96);
        opacity: 0;
      }
      to {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }

    @keyframes board-in {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes matched-pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.06);
      }
      100% {
        transform: scale(1);
      }
    }

    @keyframes pop-in {
      from {
        transform: scale(0.8) translateY(10px);
        opacity: 0;
      }
      to {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    @keyframes explode {
      0% {
        transform: translate3d(0, 40px, 0) scale(0.4);
        opacity: 0;
      }
      30% {
        opacity: 1;
      }
      80% {
        opacity: 1;
      }
      100% {
        transform: translate3d(0, -40px, 0) scale(1.2);
        opacity: 0;
      }
    }

    @keyframes bounce {
      0% {
        transform: translateX(-50%) translateY(0);
      }
      100% {
        transform: translateX(-50%) translateY(-6px);
      }
    }

    @media (max-width: 640px) {
      #game-board {
        grid-template-columns: repeat(3, minmax(70px, 1fr));
        gap: 0.7rem;
        padding: 0.7rem;
      }

      .game-wrapper {
        padding: 1.1rem 0.9rem 1.5rem;
      }
    }

    @media (max-width: 430px) {
      #game-board {
        grid-template-columns: repeat(3, minmax(60px, 1fr));
      }

      .card {
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <div class="game-wrapper" aria-label="K√∂rper Memory Spiel">
    <h1>K√∂rper Memory</h1>
    <p class="subtitle">Finde immer zwei passenden K√∂rperbilder, h√∂re zu und merke sie dir!</p>

    <div class="board-wrapper">
      <div id="game-board" aria-live="polite"></div>
    </div>

    <p class="helper-text">Erwachsene k√∂nnen helfen: zusammen laut mitsprechen, was im Audio gesagt wird.</p>
  </div>

  <!-- Overlay: matched pair preview + audio -->
  <div id="match-overlay" class="overlay hidden" aria-hidden="true">
    <div class="overlay-content">
      <h2 class="overlay-title">Super!</h2>
      <p class="overlay-subtitle">Schau genau &amp; h√∂r gut zu.</p>
      <div class="overlay-images">
        <img id="match-img-1" src="" alt="" />
        <img id="match-img-2" src="" alt="" />
      </div>
    </div>
  </div>

  <!-- Overlay: end of game + fireworks + restart button -->
  <div id="end-overlay" class="overlay hidden" aria-hidden="true">
    <div class="overlay-content">
      <div id="fireworks"></div>
      <h2 class="overlay-title">Bravo!</h2>
      <p class="overlay-subtitle">Du kennst jetzt alle K√∂rperbilder.</p>
      <button id="play-again-btn" type="button">neu spielen</button>
    </div>
  </div>

  <script>
    const pairs = [
      { id: "auge", images: ["ein_auge.png", "zwei_augen.png"], audio: "auge.wav" },
      { id: "finger", images: ["ein_finger.png", "zwei_finger.png"], audio: "finger.wav" },
      { id: "ohr", images: ["ein_ohr.png", "zwei_ohren.png"], audio: "ohr.wav" },
      { id: "hand", images: ["eine_hand.png", "zwei_haende.png"], audio: "hand.wav" },
      { id: "bein", images: ["ein_bein.png", "zwei_beine.png"], audio: "bein.wav" },
      { id: "arm", images: ["ein_arm.png", "zwei_arme.png"], audio: "arm.wav" },
    ];

    const sounds = {};
    let firstCard = null;
    let secondCard = null;
    let lockBoard = false;
    let matchedPairs = 0;
    const totalPairs = pairs.length;

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function initAudio() {
      pairs.forEach((pair) => {
        const audio = new Audio(pair.audio);
        audio.preload = "auto";
        sounds[pair.id] = audio;
      });
    }

    function createCardElement(cardData) {
      const card = document.createElement("div");
      card.className = "card";
      card.dataset.id = cardData.id;

      const inner = document.createElement("div");
      inner.className = "card-inner";

      const front = document.createElement("div");
      front.className = "card-face card-front";
      front.textContent = "?";

      const back = document.createElement("div");
      back.className = "card-face card-back";
      const img = document.createElement("img");
      img.src = cardData.image;
      img.alt = "";
      back.appendChild(img);

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);

      // üì± –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
      card.addEventListener("touchstart", (e) => {
        e.preventDefault();
        onCardClick(e);
      });
      card.addEventListener("click", onCardClick);

      return card;
    }

    function initGameBoard() {
      const board = document.getElementById("game-board");
      board.innerHTML = "";

      const cardsData = [];
      pairs.forEach((pair) => {
        pair.images.forEach((img) => {
          cardsData.push({ id: pair.id, image: img });
        });
      });

      shuffle(cardsData);
      cardsData.forEach((cardData) => {
        const cardEl = createCardElement(cardData);
        board.appendChild(cardEl);
      });
    }

    function onCardClick(e) {
      const card = e.currentTarget;
      if (lockBoard) return;
      if (card.classList.contains("flipped")) return;
      if (card.classList.contains("matched")) return;

      card.classList.add("flipped");

      if (!firstCard) {
        firstCard = card;
        return;
      }

      secondCard = card;
      lockBoard = true;
      checkForMatch();
    }

    function checkForMatch() {
      if (!firstCard || !secondCard) return;
      const isMatch = firstCard.dataset.id === secondCard.dataset.id;

      if (isMatch) {
        firstCard.classList.add("matched");
        secondCard.classList.add("matched");
        matchedPairs++;

        const img1 = firstCard.querySelector(".card-back img").src;
        const img2 = secondCard.querySelector(".card-back img").src;
        const isLastPair = matchedPairs === totalPairs;

        showMatchAndPlayAudio(img1, img2, firstCard.dataset.id, isLastPair);
      } else {
        setTimeout(() => {
          firstCard.classList.remove("flipped");
          secondCard.classList.remove("flipped");
          resetTurn();
        }, 900);
      }
    }

    function showMatchAndPlayAudio(img1, img2, pairId, isLastPair) {
      const overlay = document.getElementById("match-overlay");
      const imgEl1 = document.getElementById("match-img-1");
      const imgEl2 = document.getElementById("match-img-2");
      const board = document.getElementById("game-board");

      imgEl1.src = img1;
      imgEl2.src = img2;
      overlay.classList.remove("hidden");
      overlay.setAttribute("aria-hidden", "false");
      board.classList.add("blurred");

      const audio = sounds[pairId];
      const finishAfterAudio = () => {
        overlay.classList.add("hidden");
        overlay.setAttribute("aria-hidden", "true");
        board.classList.remove("blurred");
        resetTurn();
        if (isLastPair) showEndScreen();
      };

      if (audio) {
        audio.currentTime = 0;
        audio.onended = finishAfterAudio;
        audio.play().catch(() => setTimeout(finishAfterAudio, 600));
      } else {
        finishAfterAudio();
      }
    }

    function resetTurn() {
      firstCard = null;
      secondCard = null;
      lockBoard = false;
    }

    function createFireworks() {
      const container = document.getElementById("fireworks");
      container.innerHTML = "";
      const colors = [
        "rgba(255,107,181,0.95)",
        "rgba(255,230,109,0.95)",
        "rgba(29,211,176,0.95)",
        "rgba(108,92,231,0.95)",
        "rgba(255,159,67,0.95)",
      ];
      for (let i = 0; i < 18; i++) {
        const fw = document.createElement("div");
        fw.className = "firework";
        fw.style.left = Math.random() * 100 + "%";
        fw.style.top = Math.random() * 70 + "%";
        const color = colors[Math.floor(Math.random() * colors.length)];
        fw.style.boxShadow = `0 0 0 4px ${color}, 0 0 0 8px rgba(255,255,255,0.7), 0 0 20px ${color}`;
        fw.style.animationDelay = (Math.random() * 1.2).toFixed(2) + "s";
        container.appendChild(fw);
      }
    }

    function showEndScreen() {
      const endOverlay = document.getElementById("end-overlay");
      endOverlay.classList.remove("hidden");
      endOverlay.setAttribute("aria-hidden", "false");
      createFireworks();
    }

    function restartGame() {
      matchedPairs = 0;
      resetTurn();
      document.getElementById("end-overlay").classList.add("hidden");
      document.getElementById("end-overlay").setAttribute("aria-hidden", "true");
      document.getElementById("game-board").classList.remove("blurred");
      initGameBoard();
    }

    document.addEventListener("DOMContentLoaded", () => {
      initAudio();
      initGameBoard();
      document.getElementById("play-again-btn").addEventListener("click", restartGame);
    });
  </script>
</body>
</html>
